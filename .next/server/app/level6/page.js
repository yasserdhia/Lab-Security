(()=>{var e={};e.id=991,e.ids=[991],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7962:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c}),t(2927),t(2029),t(5866);var r=t(3191),a=t(8716),i=t(7922),n=t.n(i),l=t(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(s,o);let c=["",{children:["level6",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,2927)),"c:\\Users\\YASSER\\Documents\\GitHub\\Lab-Security\\src\\app\\level6\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,2029)),"c:\\Users\\YASSER\\Documents\\GitHub\\Lab-Security\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],d=["c:\\Users\\YASSER\\Documents\\GitHub\\Lab-Security\\src\\app\\level6\\page.tsx"],u="/level6/page",m={require:t,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/level6/page",pathname:"/level6",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},6914:(e,s,t)=>{Promise.resolve().then(t.bind(t,3243))},3243:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var r=t(326),a=t(8530);function i(){let e=async e=>{try{let s=await fetch("/api/level6",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await s.json()}catch(e){return{success:!1,error:"Failed to connect to server"}}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-cyber-dark via-gray-900 to-cyber-dark py-12",children:(0,r.jsxs)("div",{className:"container mx-auto px-6",children:[r.jsx(a.Z,{level:6,title:"Second-order Injection",description:"This level demonstrates second-order SQL injection where malicious data is stored safely but becomes dangerous when retrieved and used in subsequent queries. The vulnerability is delayed and harder to trace.",onSubmit:e,hints:["This level stores your input and executes it later","The injection happens when stored data is retrieved and used","Try storing malicious payloads that execute on the second query","Look for profile update or comment functionality","Example: Store '; DROP TABLE users-- in a field"],isVulnerable:!0}),r.jsx("div",{className:"mt-12 max-w-4xl mx-auto",children:(0,r.jsxs)("div",{className:"vulnerability-card rounded-lg p-8",children:[r.jsx("h2",{className:"text-2xl font-semibold mb-6 text-cyber-blue",children:"\uD83D\uDD0D Technical Details"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-cyber-green mb-3",children:"Second-order Attack Flow:"}),r.jsx("div",{className:"code-block",children:`-- Step 1: Store malicious data (appears safe)
INSERT INTO logs (username, action) VALUES ('admin'; DROP TABLE users--', 'login');

-- Step 2: Retrieve and use stored data (vulnerability triggers)
SELECT * FROM users WHERE username = 'admin'; DROP TABLE users--';

-- The injection executes when the stored data is used, not when stored`})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-cyber-green mb-3",children:"Why Second-order is Dangerous:"}),(0,r.jsxs)("ul",{className:"space-y-2 text-gray-300",children:[(0,r.jsxs)("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-cyber-blue mr-2",children:"•"}),"Delayed execution makes it harder to trace"]}),(0,r.jsxs)("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-cyber-blue mr-2",children:"•"}),"Input validation might pass initially"]}),(0,r.jsxs)("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-cyber-blue mr-2",children:"•"}),"Affects different parts of the application"]}),(0,r.jsxs)("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-cyber-blue mr-2",children:"•"}),"Harder to detect in security testing"]})]})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-cyber-green mb-3",children:"Attack Scenarios:"}),r.jsx("div",{className:"code-block",children:`-- Profile update attack
UPDATE users SET bio = 'Hello'; DROP TABLE users-- WHERE id = 1;

-- Comment injection
INSERT INTO comments (content) VALUES ('Nice post!'; SELECT password FROM users--');

-- Log poisoning
INSERT INTO audit_logs (action) VALUES ('login'; UPDATE users SET role='admin'--');`})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-cyber-green mb-3",children:"Prevention Strategies:"}),r.jsx("div",{className:"code-block",children:`// Always use parameterized queries for both storage AND retrieval
const storeQuery = "INSERT INTO logs (username, action) VALUES ($1, $2)";
const retrieveQuery = "SELECT * FROM users WHERE username = $1";

// Validate data both on input AND when retrieved
function validateInput(data) {
  return data.replace(/[^a-zA-Z0-9_]/g, '');
}

// Use stored procedures
CALL getUserByUsername(@username);`})]})]})]})})]})})}},2927:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(8570).createProxy)(String.raw`c:\Users\YASSER\Documents\GitHub\Lab-Security\src\app\level6\page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[276,471,802],()=>t(7962));module.exports=r})();